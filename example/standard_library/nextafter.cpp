#include <cassert>
#include <cmath>

#include <numeric>
#include <iostream>
using namespace std;

typedef unsigned int uint;

uint as_uint(const float x) {
    return *(uint *)&x;
}
float as_float(const uint x) {
    return *(float *)&x;
}

int main() {
    cout << nextafter(float(0), numeric_limits<float>::infinity()) << endl; // 1.4013e-45
    cout << nextafter(float(0), -numeric_limits<float>::infinity()) << endl; // -1.4013e-45

    cout << nextafter(double(0), numeric_limits<double>::infinity()) << endl; // 4.94066e-324
    cout << nextafter(double(0), -numeric_limits<double>::infinity()) << endl; // -4.94066e-324

    cout << endl;

    {
        float f = 0;
        const int n = 1 << 8; // 256
        const int s = 1 << 22;
        for(int i = 0; i < n; i++) {
            for(int j = 0; j < s; j++)
                f = nextafter(f, numeric_limits<float>::infinity());
            cout << f << endl;
        }
    }

    cout << endl;

    {
        float f = 0;
        const int n = 1 << 8; // 256
        const int s = 1 << 23;
        for(int i = 0; i < n; i++) {
            for(int j = 0; j < s; j++)
                f = nextafter(f, numeric_limits<float>::infinity());
            cout << f << endl;
        }
    }

    cout << endl;

    { // Direct operation on uint and convert to float. Got the same numbers as the previous, except the last one `-0` (the previous is `inf`).
        float f = 0;
        const int n = 1 << 8; // 256
        const int s = 1 << 23;
        for(int i = 0; i < n; i++) {
            uint u = as_uint(f);
            u += s;
            f = as_float(u);
            cout << f << endl;
        }
    }

    return 0;
}

/* float, n=1<<8, s=1<<22.
5.87747e-39
1.17549e-38
1.76324e-38
2.35099e-38
3.52648e-38
4.70198e-38
7.05297e-38
9.40395e-38
1.41059e-37
1.88079e-37
2.82119e-37
3.76158e-37
5.64237e-37
7.52316e-37
1.12847e-36
1.50463e-36
2.25695e-36
3.00927e-36
4.5139e-36
6.01853e-36
9.0278e-36
1.20371e-35
1.80556e-35
2.40741e-35
3.61112e-35
4.81482e-35
7.22224e-35
9.62965e-35
1.44445e-34
1.92593e-34
2.88889e-34
3.85186e-34
5.77779e-34
7.70372e-34
1.15556e-33
1.54074e-33
2.31112e-33
3.08149e-33
4.62223e-33
6.16298e-33
9.24446e-33
1.2326e-32
1.84889e-32
2.46519e-32
3.69779e-32
4.93038e-32
7.39557e-32
9.86076e-32
1.47911e-31
1.97215e-31
2.95823e-31
3.9443e-31
5.91646e-31
7.88861e-31
1.18329e-30
1.57772e-30
2.36658e-30
3.15544e-30
4.73317e-30
6.31089e-30
9.46633e-30
1.26218e-29
1.89327e-29
2.52435e-29
3.78653e-29
5.04871e-29
7.57306e-29
1.00974e-28
1.51461e-28
2.01948e-28
3.02923e-28
4.03897e-28
6.05845e-28
8.07794e-28
1.21169e-27
1.61559e-27
2.42338e-27
3.23117e-27
4.84676e-27
6.46235e-27
9.69352e-27
1.29247e-26
1.9387e-26
2.58494e-26
3.87741e-26
5.16988e-26
7.75482e-26
1.03398e-25
1.55096e-25
2.06795e-25
3.10193e-25
4.1359e-25
6.20385e-25
8.27181e-25
1.24077e-24
1.65436e-24
2.48154e-24
3.30872e-24
4.96308e-24
6.61744e-24
9.92617e-24
1.32349e-23
1.98523e-23
2.64698e-23
3.97047e-23
5.29396e-23
7.94093e-23
1.05879e-22
1.58819e-22
2.11758e-22
3.17637e-22
4.23516e-22
6.35275e-22
8.47033e-22
1.27055e-21
1.69407e-21
2.5411e-21
3.38813e-21
5.0822e-21
6.77626e-21
1.01644e-20
1.35525e-20
2.03288e-20
2.71051e-20
4.06576e-20
5.42101e-20
8.13152e-20
1.0842e-19
1.6263e-19
2.1684e-19
3.25261e-19
4.33681e-19
6.50521e-19
8.67362e-19
1.30104e-18
1.73472e-18
2.60209e-18
3.46945e-18
5.20417e-18
6.93889e-18
1.04083e-17
1.38778e-17
2.08167e-17
2.77556e-17
4.16334e-17
5.55112e-17
8.32667e-17
1.11022e-16
1.66533e-16
2.22045e-16
3.33067e-16
4.44089e-16
6.66134e-16
8.88178e-16
1.33227e-15
1.77636e-15
2.66454e-15
3.55271e-15
5.32907e-15
7.10543e-15
1.06581e-14
1.42109e-14
2.13163e-14
2.84217e-14
4.26326e-14
5.68434e-14
8.52651e-14
1.13687e-13
1.7053e-13
2.27374e-13
3.41061e-13
4.54747e-13
6.82121e-13
9.09495e-13
1.36424e-12
1.81899e-12
2.72848e-12
3.63798e-12
5.45697e-12
7.27596e-12
1.09139e-11
1.45519e-11
2.18279e-11
2.91038e-11
4.36557e-11
5.82077e-11
8.73115e-11
1.16415e-10
1.74623e-10
2.32831e-10
3.49246e-10
4.65661e-10
6.98492e-10
9.31323e-10
1.39698e-09
1.86265e-09
2.79397e-09
3.72529e-09
5.58794e-09
7.45058e-09
1.11759e-08
1.49012e-08
2.23517e-08
2.98023e-08
4.47035e-08
5.96046e-08
8.9407e-08
1.19209e-07
1.78814e-07
2.38419e-07
3.57628e-07
4.76837e-07
7.15256e-07
9.53674e-07
1.43051e-06
1.90735e-06
2.86102e-06
3.8147e-06
5.72205e-06
7.62939e-06
1.14441e-05
1.52588e-05
2.28882e-05
3.05176e-05
4.57764e-05
6.10352e-05
9.15527e-05
0.00012207
0.000183105
0.000244141
0.000366211
0.000488281
0.000732422
0.000976562
0.00146484
0.00195312
0.00292969
0.00390625
0.00585938
0.0078125
0.0117188
0.015625
0.0234375
0.03125
0.046875
0.0625
0.09375
0.125
0.1875
0.25
0.375
0.5
0.75
1
1.5
2
*/

/* float, n=1<<8, s=1<<23. Continuous prints have 2x relationship because the mantissa of float has 23 bits.
1.17549e-38
2.35099e-38
4.70198e-38
9.40395e-38
1.88079e-37
3.76158e-37
7.52316e-37
1.50463e-36
3.00927e-36
6.01853e-36
1.20371e-35
2.40741e-35
4.81482e-35
9.62965e-35
1.92593e-34
3.85186e-34
7.70372e-34
1.54074e-33
3.08149e-33
6.16298e-33
1.2326e-32
2.46519e-32
4.93038e-32
9.86076e-32
1.97215e-31
3.9443e-31
7.88861e-31
1.57772e-30
3.15544e-30
6.31089e-30
1.26218e-29
2.52435e-29
5.04871e-29
1.00974e-28
2.01948e-28
4.03897e-28
8.07794e-28
1.61559e-27
3.23117e-27
6.46235e-27
1.29247e-26
2.58494e-26
5.16988e-26
1.03398e-25
2.06795e-25
4.1359e-25
8.27181e-25
1.65436e-24
3.30872e-24
6.61744e-24
1.32349e-23
2.64698e-23
5.29396e-23
1.05879e-22
2.11758e-22
4.23516e-22
8.47033e-22
1.69407e-21
3.38813e-21
6.77626e-21
1.35525e-20
2.71051e-20
5.42101e-20
1.0842e-19
2.1684e-19
4.33681e-19
8.67362e-19
1.73472e-18
3.46945e-18
6.93889e-18
1.38778e-17
2.77556e-17
5.55112e-17
1.11022e-16
2.22045e-16
4.44089e-16
8.88178e-16
1.77636e-15
3.55271e-15
7.10543e-15
1.42109e-14
2.84217e-14
5.68434e-14
1.13687e-13
2.27374e-13
4.54747e-13
9.09495e-13
1.81899e-12
3.63798e-12
7.27596e-12
1.45519e-11
2.91038e-11
5.82077e-11
1.16415e-10
2.32831e-10
4.65661e-10
9.31323e-10
1.86265e-09
3.72529e-09
7.45058e-09
1.49012e-08
2.98023e-08
5.96046e-08
1.19209e-07
2.38419e-07
4.76837e-07
9.53674e-07
1.90735e-06
3.8147e-06
7.62939e-06
1.52588e-05
3.05176e-05
6.10352e-05
0.00012207
0.000244141
0.000488281
0.000976562
0.00195312
0.00390625
0.0078125
0.015625
0.03125
0.0625
0.125
0.25
0.5
1
2
4
8
16
32
64
128
256
512
1024
2048
4096
8192
16384
32768
65536
131072
262144
524288
1.04858e+06
2.09715e+06
4.1943e+06
8.38861e+06
1.67772e+07
3.35544e+07
6.71089e+07
1.34218e+08
2.68435e+08
5.36871e+08
1.07374e+09
2.14748e+09
4.29497e+09
8.58993e+09
1.71799e+10
3.43597e+10
6.87195e+10
1.37439e+11
2.74878e+11
5.49756e+11
1.09951e+12
2.19902e+12
4.39805e+12
8.79609e+12
1.75922e+13
3.51844e+13
7.03687e+13
1.40737e+14
2.81475e+14
5.6295e+14
1.1259e+15
2.2518e+15
4.5036e+15
9.0072e+15
1.80144e+16
3.60288e+16
7.20576e+16
1.44115e+17
2.8823e+17
5.76461e+17
1.15292e+18
2.30584e+18
4.61169e+18
9.22337e+18
1.84467e+19
3.68935e+19
7.3787e+19
1.47574e+20
2.95148e+20
5.90296e+20
1.18059e+21
2.36118e+21
4.72237e+21
9.44473e+21
1.88895e+22
3.77789e+22
7.55579e+22
1.51116e+23
3.02231e+23
6.04463e+23
1.20893e+24
2.41785e+24
4.8357e+24
9.67141e+24
1.93428e+25
3.86856e+25
7.73713e+25
1.54743e+26
3.09485e+26
6.1897e+26
1.23794e+27
2.47588e+27
4.95176e+27
9.90352e+27
1.9807e+28
3.96141e+28
7.92282e+28
1.58456e+29
3.16913e+29
6.33825e+29
1.26765e+30
2.5353e+30
5.0706e+30
1.01412e+31
2.02824e+31
4.05648e+31
8.11296e+31
1.62259e+32
3.24519e+32
6.49037e+32
1.29807e+33
2.59615e+33
5.1923e+33
1.03846e+34
2.07692e+34
4.15384e+34
8.30767e+34
1.66153e+35
3.32307e+35
6.64614e+35
1.32923e+36
2.65846e+36
5.31691e+36
1.06338e+37
2.12676e+37
4.25353e+37
8.50706e+37
1.70141e+38
inf
inf
*/

/* Direct operation on uint and convert to float. Got the same numbers as the previous, except the last one `-0` (the previous is `inf`).
1.17549e-38
2.35099e-38
4.70198e-38
9.40395e-38
1.88079e-37
3.76158e-37
7.52316e-37
1.50463e-36
3.00927e-36
6.01853e-36
1.20371e-35
2.40741e-35
4.81482e-35
9.62965e-35
1.92593e-34
3.85186e-34
7.70372e-34
1.54074e-33
3.08149e-33
6.16298e-33
1.2326e-32
2.46519e-32
4.93038e-32
9.86076e-32
1.97215e-31
3.9443e-31
7.88861e-31
1.57772e-30
3.15544e-30
6.31089e-30
1.26218e-29
2.52435e-29
5.04871e-29
1.00974e-28
2.01948e-28
4.03897e-28
8.07794e-28
1.61559e-27
3.23117e-27
6.46235e-27
1.29247e-26
2.58494e-26
5.16988e-26
1.03398e-25
2.06795e-25
4.1359e-25
8.27181e-25
1.65436e-24
3.30872e-24
6.61744e-24
1.32349e-23
2.64698e-23
5.29396e-23
1.05879e-22
2.11758e-22
4.23516e-22
8.47033e-22
1.69407e-21
3.38813e-21
6.77626e-21
1.35525e-20
2.71051e-20
5.42101e-20
1.0842e-19
2.1684e-19
4.33681e-19
8.67362e-19
1.73472e-18
3.46945e-18
6.93889e-18
1.38778e-17
2.77556e-17
5.55112e-17
1.11022e-16
2.22045e-16
4.44089e-16
8.88178e-16
1.77636e-15
3.55271e-15
7.10543e-15
1.42109e-14
2.84217e-14
5.68434e-14
1.13687e-13
2.27374e-13
4.54747e-13
9.09495e-13
1.81899e-12
3.63798e-12
7.27596e-12
1.45519e-11
2.91038e-11
5.82077e-11
1.16415e-10
2.32831e-10
4.65661e-10
9.31323e-10
1.86265e-09
3.72529e-09
7.45058e-09
1.49012e-08
2.98023e-08
5.96046e-08
1.19209e-07
2.38419e-07
4.76837e-07
9.53674e-07
1.90735e-06
3.8147e-06
7.62939e-06
1.52588e-05
3.05176e-05
6.10352e-05
0.00012207
0.000244141
0.000488281
0.000976562
0.00195312
0.00390625
0.0078125
0.015625
0.03125
0.0625
0.125
0.25
0.5
1
2
4
8
16
32
64
128
256
512
1024
2048
4096
8192
16384
32768
65536
131072
262144
524288
1.04858e+06
2.09715e+06
4.1943e+06
8.38861e+06
1.67772e+07
3.35544e+07
6.71089e+07
1.34218e+08
2.68435e+08
5.36871e+08
1.07374e+09
2.14748e+09
4.29497e+09
8.58993e+09
1.71799e+10
3.43597e+10
6.87195e+10
1.37439e+11
2.74878e+11
5.49756e+11
1.09951e+12
2.19902e+12
4.39805e+12
8.79609e+12
1.75922e+13
3.51844e+13
7.03687e+13
1.40737e+14
2.81475e+14
5.6295e+14
1.1259e+15
2.2518e+15
4.5036e+15
9.0072e+15
1.80144e+16
3.60288e+16
7.20576e+16
1.44115e+17
2.8823e+17
5.76461e+17
1.15292e+18
2.30584e+18
4.61169e+18
9.22337e+18
1.84467e+19
3.68935e+19
7.3787e+19
1.47574e+20
2.95148e+20
5.90296e+20
1.18059e+21
2.36118e+21
4.72237e+21
9.44473e+21
1.88895e+22
3.77789e+22
7.55579e+22
1.51116e+23
3.02231e+23
6.04463e+23
1.20893e+24
2.41785e+24
4.8357e+24
9.67141e+24
1.93428e+25
3.86856e+25
7.73713e+25
1.54743e+26
3.09485e+26
6.1897e+26
1.23794e+27
2.47588e+27
4.95176e+27
9.90352e+27
1.9807e+28
3.96141e+28
7.92282e+28
1.58456e+29
3.16913e+29
6.33825e+29
1.26765e+30
2.5353e+30
5.0706e+30
1.01412e+31
2.02824e+31
4.05648e+31
8.11296e+31
1.62259e+32
3.24519e+32
6.49037e+32
1.29807e+33
2.59615e+33
5.1923e+33
1.03846e+34
2.07692e+34
4.15384e+34
8.30767e+34
1.66153e+35
3.32307e+35
6.64614e+35
1.32923e+36
2.65846e+36
5.31691e+36
1.06338e+37
2.12676e+37
4.25353e+37
8.50706e+37
1.70141e+38
inf
-0
*/
